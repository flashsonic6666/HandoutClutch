<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<title></title>

<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>

#ttable{
	width=100%;
}

td {
  height: 30px;
  width: 160px;
  text-align: center;
  vertical-align: middle;
}
	
th {
  height: 30px;
  width: 160px;
  text-align: center;
  vertical-align: middle;
}	

</style>
	
</head>



<body>
	<!--Table!-->
	<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
	<table id="ttable">
	</table>
	
	<script type="text/javascript">
	
	create();
	resetTable();
		
	function resetTable(){
		$("#ttable tr").remove(); 
		
		var tableBody= "";

		tableBody = tableBody + "<tr>";
		 tableBody = tableBody + "<th>" + "   Test   " + "</th>" + "<th>" + "   Score   " + "</th>" + "<th>" + " #  Questions Correct   " + "</th>" +
			 "<th>" + "   Total Possible Score   " + "</th>" + "<th>" + "   Test Status   " + "</th>";
		 tableBody = tableBody + "</tr>";  


 		 var testCorrectness=JSON.parse(localStorage.getItem("testCorrectness"));
		var testFolderName=JSON.parse(localStorage.getItem("testFolderName"));
		
		// iterate localStorage
		for (var i = 0; i < testCorrectness.length; i++) {
		  
			var putt=getPoints(i);

			  // console.log the iteration key and value
			  tableBody = tableBody + "<tr>";
			  tableBody = tableBody + "<td><a onclick=\"updateFocus(" + i + ");\" href=\"practiceAMC12/" + testFolderName[i] +  "/home\" >"
				  + putt[0] + "</a></td>" + "<td>" + putt[1] + "</td>" + "<td>" + putt[2] + "</td>" + "<td>" + putt[3] + "</td>" + "<td>" + putt[4] + "</td>";
			  tableBody = tableBody + "</tr>";  

		}
		
		$("#ttable").append(tableBody);
	}
	
   function getPoints(p1){
      
      //Holds points, required points, percentage, total points in handout
      var ans=[];
	   
      var score=0;
      var correct=0;
      var total=150;
      
      var testCorrectness=JSON.parse(localStorage.getItem("testCorrectness"));
      var testName=JSON.parse(localStorage.getItem("testName"));
      var testStatus=JSON.parse(localStorage.getItem("testStatus"));
	
      for(var i=0; i<testCorrectness[parseInt(p1)].length; i++){
        if(testCorrectness[parseInt(p1)].charAt(i)=='1'){
           score+=1.5;
         }
        else if(testCorrectness[parseInt(p1)].charAt(i)=='2'){
	     correct++;
             score+=6;   
        }
        
      }
	   
      ans.push(testName[parseInt(p1)]);   
      ans.push(score);
      ans.push(correct);
      ans.push(total);
      
	if(parseInt(testStatus[parseInt(p1)])==0){
	   	ans.push("Not Started");
	}
	else if(parseInt(testStatus[parseInt(p1)])==1){
		ans.push("In Progress");
	}
	else{
		ans.push("Completed");
	}
      
      return ans;
   }
	function create(){
		//Absolute new
		localStorage.setItem("testCode", JSON.stringify(["10a","10b","11a","11b","12a"]));
		localStorage.setItem("testAnswers", JSON.stringify([["C","A","E","D","C","E","C","C","A","A","C","D","C","B","D","B","E","D","A","C","A","A","A","B","C"],
								   ["C","A","E","B","D","D","C","B","E","B","E","D","C","B","D","E","D","C","E","E","B","D","A","C","D"],
								   ["D","E","E","C","C","A","B","C","B","B","C","D","B","E","A","C","D","D","C","C","A","C","C","C","D"],
								   ["C","E","C","E","A","C","B","A","D","E","B","A","B","D","D","C","B","A","B","C","D","D","C","B","D"],
								   ["E","D","D","C","D","D","C","C","A","D","B","D","D","E","A","E","B","A","B","B","E","C","C","C","C"]]));
		localStorage.setItem("testName", JSON.stringify(["2010 AMC12A","2010 AMC12B","2011 AMC12A","2011 AMC12B","2012 AMC12A"]));
		localStorage.setItem("10a", 0);
		localStorage.setItem("10b", 1);
		localStorage.setItem("11a", 2);
		localStorage.setItem("11b", 3);
		localStorage.setItem("12a", 4);
		localStorage.setItem("testFolderName", JSON.stringify(["2010A","2010B","2011A","2011B","2012A"]));
		localStorage.setItem("aimeCutoff", JSON.stringify(["88.5","88.5","93","97.5","94.5"]));
		
		if(localStorage.getItem("testCorrectness")===null){
			localStorage.setItem("testCorrectness", JSON.stringify(["0000000000000000000000000"]));
		}
		
		if(localStorage.getItem("currentTest")===null){
			localStorage.setItem("currentTest",0);
		}
		
		if(localStorage.getItem("testStatus")===null){
			localStorage.setItem("testStatus", JSON.stringify(["0"]));
		}
		
		if(localStorage.getItem("testTime")===null){
			localStorage.setItem("testTime", JSON.stringify([60*60*1000]));
		}
		
		if(localStorage.getItem("testUserAnswers")===null){
			localStorage.setItem("testUserAnswers", JSON.stringify([]));
		}
		
		//Updates
		var testAnswers=JSON.parse(localStorage.getItem("testAnswers"));
		var testName=JSON.parse(localStorage.getItem("testName"));
		var testUserAnswers=JSON.parse(localStorage.getItem("testUserAnswers"));
		
		var testCorrectness=JSON.parse(localStorage.getItem("testCorrectness"));
		var testStatus=JSON.parse(localStorage.getItem("testStatus"));
		var testTime=JSON.parse(localStorage.getItem("testTime"));
		
		while(testCorrectness.length<testName.length){
			var temp="";
			for(var i=0; i<testAnswers[testCorrectness.length].length; i++){
				temp+="0";
			}
			testCorrectness.push(temp);
			testStatus.push("0");
			testTime.push(60*60*1000);
		}
		
		while(testUserAnswers.length<testName.length){
		      testUserAnswers.push([]);
		}
		
		localStorage.setItem("testCorrectness", JSON.stringify(testCorrectness));
		localStorage.setItem("testStatus", JSON.stringify(testStatus));
		localStorage.setItem("testTime", JSON.stringify(testTime));
		localStorage.setItem("testUserAnswers", JSON.stringify(testUserAnswers));
	}
	function updateFocus(x){
		localStorage.setItem("currentTest",x);
	}
        </script>
</body>
</html>
